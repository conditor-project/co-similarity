language: node_js

sudo: true
addons:
  apt:
    packages:
      - oracle-java8-set-default
before_script:
  - sleep 10
node_js:
  - "8"
before_install:
  - curl -O https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.4.3.deb && sudo dpkg -i --force-confnew elasticsearch-6.4.3.deb && sudo service elasticsearch start
  - sudo -E /usr/share/elasticsearch/bin/elasticsearch-plugin install analysis-icu
  - sudo service elasticsearch restart
notifications:
  email:
    recipients:
      - claude.niederlender@inist.fr
      - conditordev@gmail.com
    on_success: change
on_failure: always
env:
  global:
    - CONDITOR_ES_HOSTS=localhost:9200
    - REVERSE_PROXY="0.0.0.0"
